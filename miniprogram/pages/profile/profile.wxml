<!--pages/profile/profile.wxml-->
<view class="page-container">
  <view class="content-container">
    <!-- 用户信息卡片 -->
    <view class="user-card" bindtap="changeAvatar">
      <view class="user-avatar">
        <image class="avatar-img" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="avatar-edit">✏️</view>
      </view>
      <view class="user-info">
        <text class="user-name">{{userInfo.nickName || '学习者'}}</text>
        <text class="user-desc">坚持学习，每天进步</text>
      </view>
    </view>

    <!-- 数据统计 -->
    <view class="stats-grid">
      <view class="stats-item">
        <text class="stats-number">{{totalDays}}</text>
        <text class="stats-label">学习天数</text>
      </view>
      <view class="stats-item">
        <text class="stats-number">{{streakDays}}</text>
        <text class="stats-label">连续天数</text>
      </view>
      <view class="stats-item">
        <text class="stats-number">{{totalVideos}}</text>
        <text class="stats-label">视频数量</text>
      </view>
      <view class="stats-item">
        <text class="stats-number">{{totalWords}}</text>
        <text class="stats-label">文字记录</text>
      </view>
    </view>

    <!-- 成就系统 -->
    <view class="achievement-card">
      <view class="card-header">
        <text class="card-title">学习成就</text>
        <text class="achievement-count">{{unlockedCount}}/{{totalAchievements}}</text>
      </view>
      <view class="achievement-list">
        <view class="achievement-item {{item.unlocked ? 'unlocked' : 'locked'}}" wx:for="{{achievements}}" wx:key="id">
          <view class="achievement-icon">{{item.icon}}</view>
          <view class="achievement-info">
            <text class="achievement-name">{{item.name}}</text>
            <text class="achievement-desc">{{item.description}}</text>
          </view>
          <view class="achievement-status">
            <text wx:if="{{item.unlocked}}" class="status-unlocked">已获得</text>
            <text wx:else class="status-locked">{{item.progress}}/{{item.target}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 功能菜单 -->
    <view class="menu-section">
      <view class="menu-item" bindtap="exportData">
        <view class="menu-icon">📊</view>
        <text class="menu-title">导出数据</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="shareApp">
        <view class="menu-icon">📤</view>
        <text class="menu-title">分享应用</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="feedback">
        <view class="menu-icon">💬</view>
        <text class="menu-title">意见反馈</text>
        <text class="menu-arrow">›</text>
      </view>
      <view class="menu-item" bindtap="about">
        <view class="menu-icon">ℹ️</view>
        <text class="menu-title">关于我们</text>
        <text class="menu-arrow">›</text>
      </view>
    </view>

    <!-- 设置选项 -->
    <view class="settings-section">
      <view class="settings-item">
        <text class="settings-title">每日提醒</text>
        <switch class="settings-switch" checked="{{reminderEnabled}}" bindchange="toggleReminder"></switch>
      </view>
      <view class="settings-item">
        <text class="settings-title">数据同步</text>
        <switch class="settings-switch" checked="{{syncEnabled}}" bindchange="toggleSync"></switch>
      </view>
      <view class="settings-item" bindtap="about">
        <text class="settings-title">缓存大小</text>
        <text class="settings-value">{{cacheSize}}</text>
      </view>
    </view>
  </view>
</view>

<!-- 导出数据弹窗 -->
<view class="modal-overlay {{showExportModal ? 'show' : ''}}" bindtap="hideExportModal">
  <view class="modal-content" catchtap="">
    <view class="modal-header">
      <text class="modal-title">导出学习数据</text>
      <button class="modal-close" bindtap="hideExportModal">×</button>
    </view>
    <view class="modal-body">
      <view class="export-options">
        <view class="export-option {{exportType === 'excel' ? 'selected' : ''}}" bindtap="selectExportType" data-type="excel">
          <view class="option-icon">📊</view>
          <text class="option-title">Excel表格</text>
        </view>
        <view class="export-option {{exportType === 'pdf' ? 'selected' : ''}}" bindtap="selectExportType" data-type="pdf">
          <view class="option-icon">📄</view>
          <text class="option-title">PDF报告</text>
        </view>
      </view>
      <view class="date-range">
        <text class="range-label">时间范围：</text>
        <view class="date-options">
          <view class="date-option {{dateRange === 'week' ? 'active' : ''}}" bindtap="selectDateRange" data-range="week">近一周</view>
          <view class="date-option {{dateRange === 'month' ? 'active' : ''}}" bindtap="selectDateRange" data-range="month">近一月</view>
          <view class="date-option {{dateRange === 'all' ? 'active' : ''}}" bindtap="selectDateRange" data-range="all">全部</view>
        </view>
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn btn-secondary" bindtap="hideExportModal">取消</button>
      <button class="btn btn-primary" bindtap="confirmExport">导出</button>
    </view>
  </view>
</view>